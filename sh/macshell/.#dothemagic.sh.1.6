
cd ../../other/plots
pwd
rm -f ./plot.plt
rm -f ./Percentage_of_Infected_Population
rm -f ./Epidemic_Curve
rm -f ./Global_Estimated_Rate
rm -f ./Local_Estimated_Rate
rm -f ./P2P
rm -f ./Unconstraint_Model

#rename the files in a proper style
CURVE=`ls -lt | head -n 7 | tail -n 6 | awk '{ print $8 ; }' | head -n 1` 
PERCENTAGE=`ls -lt | head -n 7 | tail -n 6 | awk '{ print $8 ; }' | head -n 2 | tail -n 1`  
GLOBAL=`ls -lt | head -n 7 | tail -n 6 | awk '{ print $8 ; }' | head -n 3 | tail -n 1` 
LOCAL=`ls -lt | head -n 7 | tail -n 6 | awk '{ print $8 ; }' | head -n 4 | tail -n 1` 
P2P=`ls -lt | head -n 7 | tail -n 6 | awk '{ print $8 ; }' | head -n 5 | tail -n 1` 
MODEL=`ls -lt | head -n 7 | tail -n 6 | awk '{ print $8 ; }' | head -n 6 | tail -n 1` 
echo $PERCENTAGE | xargs cat > Percentage_of_Infected_Population
echo $CURVE | xargs cat > Epidemic_Curve 
echo $GLOBAL| xargs cat > Global_Estimated_Rate
echo $LOCAL | xargs cat > Local_Estimated_Rate
echo $P2P | xargs cat >  P2P
cd ../statistics
N=`ls -lt | head -n 2 | tail -n 1 | awk '{ print $8 ; }' | xargs cat | grep "Total population" | head -n 1 | awk '{ print $3; }'` 
p2=`ls -lt | head -n 2 | tail -n 1 | awk '{ print $8 ; }' | xargs cat | grep "P2P" | head -n 1 | awk '{ print $8; }'`
R=`ls -lt | head -n 2 | tail -n 1 | awk '{ print $8 ; }' | xargs cat | grep "immune" | head -n 1 | awk '{ print $6; }'`
I=`ls -lt | head -n 2 | tail -n 1 | awk '{ print $8 ; }' | xargs cat | grep "Initial" | head -n 1 | awk '{ print $4; }'`
L=$(echo `wc -l ../../GraphTopology.txt | awk '{ print $1; }'`/2 | bc)

echo "Graph size $N - Number of edges $L - Initial infected nodes $I - Initial immune nodes $R - P2P members $p2"

echo "set grid" > plot.plt
echo "N=$N" >> plot.plt
echo "set xrange[0:40]" 
echo 'set title "Graph size N - Number of edges $L - Initial infected nodes $I - Initial immune nodes $R - P2P members $p2"' >> plot.plt
echo 'plot "Percentage_of_Infected_Population" with linespoints, "Epidemic_Curve" with linespoints, \
"Global_Estimated_Rate" with linespoints, "Local_Estimated_Rate" with linespoints' >> plot.plt
echo "pause -1" >> plot.plt

mv ./plot.plt ../../other/plots/plot.plt
